var socket=io(),selfName="",selfUsername="";socket.on("metadata",function(a){selfName=a.name,selfUsername=a.username});var ChatPiApp=angular.module("ChatPiApp",["angularModalService","ui.bootstrap"]);ChatPiApp.factory("Message",function(){var a=function(a,b){this.contents=a,this.type=b};return a}),ChatPiApp.service("getDate",function(){this.currentDateInMinutes=function(){return Math.ceil(Date.now()/1e3/60)}}),ChatPiApp.filter("dateParser",function(){return function(a,b){var c=b-a;return 1>c?"less than a minute ago":1==c?"1 minute ago":60>c?c+" minutes ago":120>c?"1 hour ago":1440>c?Math.round(c/60)+" hours ago":2880>c?"1 day ago":10080>c?Math.round(c/60/24)+"days ago":a.toLocaleDateString()}}),ChatPiApp.controller("Conversation",function(a,b,c){a.getDateInMinutes=c.currentDateInMinutes,a.conversation={message_history:[],new_message:""},a.send=function(){var c=a.conversation.new_message.replace(/\s/g,"");if(""!==c){var d=new b(a.conversation.new_message,"text");socket.emit("message",d),a.conversation.new_message=""}},socket.on("message",function(b){b.self=b.senderUsername==selfUsername?"self":"",a.$apply(a.conversation.message_history.push(b))})}),socket.on("disconnect",function(){console.log("disconnected")}),socket.on("error",function(a){console.error("An error occured with the connection to the chat server \n"+a)}),ChatPiApp.directive("open-modal",function(){var a={link:function(b,c){c.bind("click",a)}};return a}),ChatPiApp.controller("ModalDemoCtrl",function(a,b,c){a.items=["item1","item2","item3"],a.open=function(d){var e=b.open({templateUrl:"myModalContent.html",controller:"ModalInstanceCtrl",size:d,resolve:{items:function(){return a.items}}});e.result.then(function(b){a.selected=b},function(){c.info("Modal dismissed at: "+new Date)})}}),ChatPiApp.controller("ModalInstanceCtrl",function(a,b,c){a.items=c,a.selected={item:a.items[0]},a.ok=function(){b.close(a.selected.item)},a.cancel=function(){b.dismiss("cancel")}});